<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê·¼ë¬´í‘œ - YesOkLab</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #ddd6fe 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        /* í—¤ë” */
        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%);
            color: white;
            padding: 30px 20px;
        }

        .header h1 {
            text-align: center;
            font-size: 2em;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .month-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 400px;
            margin: 0 auto;
        }

        .month-nav button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.5em;
            transition: background 0.2s;
        }

        .month-nav button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .month-nav h2 {
            font-size: 1.5em;
            font-weight: bold;
        }

        /* ì„¤ì • ë²„íŠ¼ */
        .settings-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.2s;
            font-weight: 500;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-size: 1.5em;
            color: #4f46e5;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #6b7280;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4f46e5;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .radio-label input[type="radio"] {
            width: auto;
            cursor: pointer;
        }

        .save-btn {
            width: 100%;
            padding: 12px;
            background: #4f46e5;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .save-btn:hover {
            background: #4338ca;
        }

        .current-setting {
            background: #f0fdf4;
            border: 2px solid #86efac;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .current-setting h3 {
            color: #16a34a;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .current-setting p {
            color: #166534;
            margin: 5px 0;
        }

        /* ë²”ë¡€ */
        .legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-icon {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .legend-icon svg {
            width: 14px;
            height: 14px;
        }

        .legend-text {
            font-size: 0.9em;
            font-weight: 500;
        }

        .icon-day {
            background: #f59e0b;
        }

        .icon-night {
            background: #4f46e5;
        }

        .icon-off {
            background: #9ca3af;
        }

        .icon-dayshift {
            background: #10b981;
        }

        .icon-holiday {
            background: #ef4444;
        }

        /* ìš”ì¼ í—¤ë” */
        .weekday-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background: #f3f4f6;
            border-bottom: 1px solid #e5e7eb;
        }

        .weekday {
            text-align: center;
            padding: 15px 0;
            font-weight: bold;
            font-size: 0.9em;
        }

        .weekday.sun {
            color: #dc2626;
        }

        .weekday.sat {
            color: #2563eb;
        }

        /* ë‹¬ë ¥ */
        .calendar {
            padding: 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0;
        }

        .day-cell {
            aspect-ratio: 1;
            padding: 4px;
            border: 1px solid #e5e7eb;
        }

        .day-content {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .day-number {
            text-align: right;
            font-size: 0.75em;
            font-weight: 600;
            color: #374151;
            padding: 2px;
        }

        .shift-badge {
            flex-grow: 1;
            margin-top: 4px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 4px;
            transition: transform 0.2s;
        }

        .shift-badge:hover {
            transform: scale(1.05);
        }

        .shift-badge svg {
            width: 16px;
            height: 16px;
            margin-bottom: 4px;
        }

        .shift-label {
            font-size: 0.75em;
            font-weight: bold;
        }

        .shift-time {
            font-size: 0.6em;
            opacity: 0.9;
            margin-top: 2px;
        }

        .shift-day {
            background: #f59e0b;
        }

        .shift-night {
            background: #4f46e5;
        }

        .shift-off {
            background: #9ca3af;
        }

        .shift-dayshift {
            background: #10b981;
        }

        .shift-holiday {
            background: #ef4444;
        }

        .today {
            box-shadow: 0 0 0 2px #3b82f6;
        }

        /* í‘¸í„° */
        .footer {
            padding: 20px;
            background: #f9fafb;
            border-top: 1px solid #e5e7eb;
            text-align: center;
            color: #6b7280;
            font-size: 0.9em;
        }

        .footer p {
            margin: 5px 0;
        }

        .footer-brand {
            color: #4f46e5;
            font-weight: 600;
            margin-top: 10px;
        }

        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 12px;
            margin-top: 15px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #1e40af;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .month-nav h2 {
                font-size: 1.2em;
            }

            .settings-btn {
                position: static;
                display: block;
                margin: 0 auto 15px;
                width: fit-content;
            }

            .legend {
                gap: 10px;
                padding: 15px;
            }

            .legend-text {
                font-size: 0.8em;
            }

            .day-number {
                font-size: 0.65em;
            }

            .shift-label {
                font-size: 0.65em;
            }

            .shift-time {
                font-size: 0.55em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header" style="position: relative;">
            <button class="settings-btn" onclick="openSettings()">âš™ï¸ ê·¼ë¬´ì¡° ì„¤ì •</button>
            <h1>ê·¼ë¬´í‘œ</h1>
            <div class="month-nav">
                <button onclick="changeMonth(-1)">â€¹</button>
                <h2 id="currentMonth"></h2>
                <button onclick="changeMonth(1)">â€º</button>
            </div>
        </div>
        
        <!-- ë²”ë¡€ -->
        <div class="legend" id="legend">
            <div class="legend-item">
                <div class="legend-icon icon-dayshift">
                    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </div>
                <span class="legend-text">ì£¼ê°„ê·¼ë¬´ (08:00-17:00)</span>
            </div>
            <div class="legend-item">
                <div class="legend-icon icon-holiday">
                    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                        <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                        <line x1="6" y1="1" x2="6" y2="4"></line>
                        <line x1="10" y1="1" x2="10" y2="4"></line>
                        <line x1="14" y1="1" x2="14" y2="4"></line>
                    </svg>
                </div>
                <span class="legend-text">ì£¼ë§/ê³µíœ´ì¼</span>
            </div>
        </div>
        
        <!-- ìš”ì¼ í—¤ë” -->
        <div class="weekday-header">
            <div class="weekday sun">ì¼</div>
            <div class="weekday">ì›”</div>
            <div class="weekday">í™”</div>
            <div class="weekday">ìˆ˜</div>
            <div class="weekday">ëª©</div>
            <div class="weekday">ê¸ˆ</div>
            <div class="weekday sat">í† </div>
        </div>
        
        <!-- ë‹¬ë ¥ -->
        <div class="calendar">
            <div id="calendar" class="calendar-grid"></div>
        </div>
        
        <!-- í‘¸í„° -->
        <div class="footer">
            <p><strong>ê·¼ë¬´ ìœ í˜•:</strong> <span id="patternInfo">ê·¼ë¬´ì¡° ì„¤ì •ì„ í•´ì£¼ì„¸ìš”</span></p>
            <p style="font-size: 0.85em;" id="teamInfo">âš™ï¸ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ê·¼ë¬´ì¡°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>
            <p class="footer-brand">YesOkLab</p>
        </div>
    </div>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>âš™ï¸ ê·¼ë¬´ì¡° ì„¤ì •</h2>
                <button class="close-btn" onclick="closeSettings()">Ã—</button>
            </div>

            <div class="current-setting" id="currentSetting" style="display: none;">
                <h3>âœ“ í˜„ì¬ ì„¤ì •</h3>
                <p id="currentTeamDisplay"></p>
            </div>

            <form onsubmit="saveSettings(event)">
                <div class="form-group">
                    <label>ê·¼ë¬´ì¡° ì„ íƒ</label>
                    <select id="teamSelect" required>
                        <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                        <option value="dayshift">ì£¼ê°„ì¡° (ì£¼5ì¼ ê·¼ë¬´)</option>
                        <option value="A">Aì¡° (êµëŒ€ê·¼ë¬´)</option>
                        <option value="B">Bì¡° (êµëŒ€ê·¼ë¬´)</option>
                        <option value="C">Cì¡° (êµëŒ€ê·¼ë¬´)</option>
                        <option value="custom">ì§ì ‘ ì„¤ì •</option>
                    </select>
                </div>

                <div id="customSettings" style="display: none;">
                    <div class="form-group">
                        <label>ì‹œì‘ ë‚ ì§œ</label>
                        <input type="date" id="startDate">
                    </div>

                    <div class="form-group">
                        <label>ì‹œì‘ ê·¼ë¬´</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="startShift" value="day">
                                <span>ì£¼ê°„</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="startShift" value="night">
                                <span>ì•¼ê°„</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <strong>ğŸ’¡ ì•ˆë‚´:</strong><br>
                    â€¢ <strong>ì£¼ê°„ì¡°</strong>: ì›”~ê¸ˆ 08:00-17:00, í† ì¼ ë° ê³µíœ´ì¼ íœ´ë¬´<br>
                    â€¢ <strong>A/B/Cì¡°</strong>: êµëŒ€ê·¼ë¬´ (4ì¼ ê·¼ë¬´ â†’ 2ì¼ íœ´ë¬´ â†’ ë°˜ë³µ)<br>
                    â€¢ <strong>ì§ì ‘ ì„¤ì •</strong>: ì›í•˜ëŠ” ë‚ ì§œì™€ ì‹œì‘ ê·¼ë¬´ ì…ë ¥<br>
                    â€¢ ì„¤ì •ì€ ë¸Œë¼ìš°ì €ì— ì €ì¥ë˜ì–´ ë‹¤ìŒì—ë„ ìœ ì§€ë©ë‹ˆë‹¤
                </div>

                <button type="submit" class="save-btn">ì €ì¥</button>
            </form>
        </div>
    </div>

    <script>
        let currentDate = new Date();
        let startDate = new Date(2025, 10, 22); // ê¸°ë³¸ê°’: 2025ë…„ 11ì›” 22ì¼
        let startShiftType = 'night'; // ê¸°ë³¸ê°’: ì•¼ê°„
        let workType = 'rotating'; // ê¸°ë³¸ê°’: êµëŒ€ê·¼ë¬´
        
        const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', 
                          '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
        
        const icons = {
            night: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>',
            day: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>',
            off: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></svg>',
            dayshift: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>',
            holiday: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></svg>'
        };

        // í•œêµ­ ê³µíœ´ì¼ (2025ë…„)
        const holidays = [
            '2025-01-01', '2025-01-28', '2025-01-29', '2025-01-30',
            '2025-03-01', '2025-03-03', '2025-05-05', '2025-05-06',
            '2025-06-06', '2025-08-15', '2025-10-03', 
            '2025-10-06', '2025-10-07', '2025-10-08', '2025-10-09',
            '2025-12-25'
        ];

        // ì¡°ë³„ ê¸°ë³¸ ì„¤ì •
        const teamPresets = {
            'dayshift': { type: 'dayshift' },
            'A': { date: '2025-11-22', shift: 'night', type: 'rotating' },
            'B': { date: '2025-11-26', shift: 'off', type: 'rotating' },
            'C': { date: '2025-11-28', shift: 'day', type: 'rotating' }
        };
        
        // ê³µíœ´ì¼ ì²´í¬
        function isHoliday(date) {
            const dateStr = date.toISOString().split('T')[0];
            return holidays.includes(dateStr);
        }

        // ì£¼ê°„ì¡° ê·¼ë¬´ íƒ€ì… ê³„ì‚°
        function getDayshiftType(date) {
            const dayOfWeek = date.getDay();
            
            if (isHoliday(date)) {
                return 'holiday';
            }
            
            if (dayOfWeek === 0 || dayOfWeek === 6) {
                return 'holiday';
            }
            
            return 'dayshift';
        }

        // êµëŒ€ê·¼ë¬´ íƒ€ì… ê³„ì‚° (12ì¼ ì‚¬ì´í´: 4ê·¼ë¬´-2íœ´ë¬´-4ê·¼ë¬´-2íœ´ë¬´)
        function getRotatingShiftType(date) {
            const diffTime = date - startDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            const cycleDay = ((diffDays % 12) + 12) % 12; // 12ì¼ ì‚¬ì´í´
            
            if (startShiftType === 'day') {
                // ì£¼ê°„ ì‹œì‘: ì£¼ê°„4 â†’ íœ´ë¬´2 â†’ ì•¼ê°„4 â†’ íœ´ë¬´2
                if (cycleDay < 4) return 'day';      // 0-3: ì£¼ê°„
                if (cycleDay < 6) return 'off';      // 4-5: íœ´ë¬´
                if (cycleDay < 10) return 'night';   // 6-9: ì•¼ê°„
                return 'off';                        // 10-11: íœ´ë¬´
            } else if (startShiftType === 'night') {
                // ì•¼ê°„ ì‹œì‘: ì•¼ê°„4 â†’ íœ´ë¬´2 â†’ ì£¼ê°„4 â†’ íœ´ë¬´2
                if (cycleDay < 4) return 'night';    // 0-3: ì•¼ê°„
                if (cycleDay < 6) return 'off';      // 4-5: íœ´ë¬´
                if (cycleDay < 10) return 'day';     // 6-9: ì£¼ê°„
                return 'off';                        // 10-11: íœ´ë¬´
            } else {
                // íœ´ë¬´ ì‹œì‘ (Bì¡°)
                if (cycleDay < 2) return 'off';      // 0-1: íœ´ë¬´
                if (cycleDay < 6) return 'day';      // 2-5: ì£¼ê°„
                if (cycleDay < 8) return 'off';      // 6-7: íœ´ë¬´
                return 'night';                      // 8-11: ì•¼ê°„
            }
        }
        
        // ê·¼ë¬´ íƒ€ì… ê³„ì‚° (í†µí•©)
        function getShiftType(date) {
            if (workType === 'dayshift') {
                return getDayshiftType(date);
            } else {
                return getRotatingShiftType(date);
            }
        }
        
        // ê·¼ë¬´ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        function getShiftInfo(type) {
            switch(type) {
                case 'night':
                    return { label: 'ì•¼ê°„', className: 'shift-night', icon: icons.night, time: '20:00-08:00' };
                case 'day':
                    return { label: 'ì£¼ê°„', className: 'shift-day', icon: icons.day, time: '08:00-20:00' };
                case 'off':
                    return { label: 'íœ´ë¬´', className: 'shift-off', icon: icons.off, time: '' };
                case 'dayshift':
                    return { label: 'ê·¼ë¬´', className: 'shift-dayshift', icon: icons.dayshift, time: '08:00-17:00' };
                case 'holiday':
                    return { label: 'íœ´ë¬´', className: 'shift-holiday', icon: icons.holiday, time: '' };
                default:
                    return null;
            }
        }

        // ë²”ë¡€ ì—…ë°ì´íŠ¸
        function updateLegend() {
            const legendHTML = workType === 'dayshift' ? `
                <div class="legend-item">
                    <div class="legend-icon icon-dayshift">
                        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </div>
                    <span class="legend-text">ì£¼ê°„ê·¼ë¬´ (08:00-17:00)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon icon-holiday">
                        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                            <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                            <line x1="6" y1="1" x2="6" y2="4"></line>
                            <line x1="10" y1="1" x2="10" y2="4"></line>
                            <line x1="14" y1="1" x2="14" y2="4"></line>
                        </svg>
                    </div>
                    <span class="legend-text">ì£¼ë§/ê³µíœ´ì¼</span>
                </div>
            ` : `
                <div class="legend-item">
                    <div class="legend-icon icon-day">
                        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </div>
                    <span class="legend-text">ì£¼ê°„ (08:00-20:00)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon icon-night">
                        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </div>
                    <span class="legend-text">ì•¼ê°„ (20:00-08:00)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon icon-off">
                        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                            <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                            <line x1="6" y1="1" x2="6" y2="4"></line>
                            <line x1="10" y1="1" x2="10" y2="4"></line>
                            <line x1="14" y1="1" x2="14" y2="4"></line>
                        </svg>
                    </div>
                    <span class="legend-text">íœ´ë¬´</span>
                </div>
            `;
            
            document.getElementById('legend').innerHTML = legendHTML;
        }
        
        // ë‹¬ë ¥ ë Œë”ë§
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            
            let html = '';
            
            // ë¹ˆ ì¹¸
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="day-cell"></div>';
            }
            
            // ë‚ ì§œ
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const shiftType = getShiftType(date);
                const shiftInfo = getShiftInfo(shiftType);
                const isToday = date.toDateString() === today.toDateString();
                
                html += `
                    <div class="day-cell ${isToday ? 'today' : ''}">
                        <div class="day-content">
                            <div class="day-number">${day}</div>
                            ${shiftInfo ? `
                                <div class="shift-badge ${shiftInfo.className}">
                                    ${shiftInfo.icon}
                                    <div class="shift-label">${shiftInfo.label}</div>
                                    ${shiftInfo.time ? `<div class="shift-time">${shiftInfo.time}</div>` : ''}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('calendar').innerHTML = html;
            document.getElementById('currentMonth').textContent = 
                `${year}ë…„ ${monthNames[month]}`;
        }
        
        // ì›” ë³€ê²½
        function changeMonth(increment) {
            currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + increment, 1);
            renderCalendar();
        }

        // ì„¤ì • ëª¨ë‹¬ ì—´ê¸°
        function openSettings() {
            document.getElementById('settingsModal').classList.add('active');
            loadCurrentSettings();
        }

        // ì„¤ì • ëª¨ë‹¬ ë‹«ê¸°
        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        // í˜„ì¬ ì„¤ì • í‘œì‹œ
        function loadCurrentSettings() {
            const saved = localStorage.getItem('shiftSettings');
            if (saved) {
                const settings = JSON.parse(saved);
                const currentSetting = document.getElementById('currentSetting');
                const currentTeamDisplay = document.getElementById('currentTeamDisplay');
                
                currentSetting.style.display = 'block';
                
                if (settings.team === 'dayshift') {
                    currentTeamDisplay.innerHTML = `<strong>ì£¼ê°„ì¡°</strong> (ì£¼5ì¼ ê·¼ë¬´, 08:00-17:00)`;
                } else if (settings.team && settings.team !== 'custom') {
                    currentTeamDisplay.innerHTML = `
                        <strong>${settings.team}ì¡°</strong> (êµëŒ€ê·¼ë¬´)<br>
                        ì‹œì‘ì¼: ${settings.startDate}<br>
                        ì‹œì‘ ê·¼ë¬´: ${settings.startShift === 'day' ? 'ì£¼ê°„' : settings.startShift === 'night' ? 'ì•¼ê°„' : 'íœ´ë¬´'}
                    `;
                } else {
                    currentTeamDisplay.innerHTML = `
                        ì‹œì‘ì¼: ${settings.startDate}<br>
                        ì‹œì‘ ê·¼ë¬´: ${settings.startShift === 'day' ? 'ì£¼ê°„' : settings.startShift === 'night' ? 'ì•¼ê°„' : 'íœ´ë¬´'}
                    `;
                }
            }
        }

        // ì¡° ì„ íƒ ì‹œ ì²˜ë¦¬
        document.getElementById('teamSelect').addEventListener('change', function(e) {
            const customSettings = document.getElementById('customSettings');
            const team = e.target.value;
            
            if (team === 'custom') {
                customSettings.style.display = 'block';
                document.getElementById('startDate').required = true;
            } else if (team === 'dayshift') {
                customSettings.style.display = 'none';
                document.getElementById('startDate').required = false;
            } else if (team && teamPresets[team]) {
                customSettings.style.display = 'none';
                document.getElementById('startDate').required = false;
                
                const preset = teamPresets[team];
                if (preset.date) {
                    document.getElementById('startDate').value = preset.date;
                    document.querySelector(`input[name="startShift"][value="${preset.shift}"]`).checked = true;
                }
            } else {
                customSettings.style.display = 'none';
                document.getElementById('startDate').required = false;
            }
        });

        // ì„¤ì • ì €ì¥
        function saveSettings(event) {
            event.preventDefault();
            
            const team = document.getElementById('teamSelect').value;
            let date, shift, type;
            
            if (team === 'dayshift') {
                type = 'dayshift';
            } else if (team === 'custom') {
                date = document.getElementById('startDate').value;
                shift = document.querySelector('input[name="startShift"]:checked').value;
                type = 'rotating';
            } else if (teamPresets[team]) {
                const preset = teamPresets[team];
                date = preset.date;
                shift = preset.shift;
                type = preset.type;
            } else {
                alert('ê·¼ë¬´ì¡°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”');
                return;
            }
            
            const settings = {
                team: team,
                startDate: date,
                startShift: shift,
                workType: type
            };
            
            localStorage.setItem('shiftSettings', JSON.stringify(settings));
            
            // ì„¤ì • ì ìš©
            workType = type;
            if (type === 'rotating') {
                const [year, month, day] = date.split('-');
                startDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
                startShiftType = shift;
            }
            
            // ì •ë³´ ì—…ë°ì´íŠ¸
            updateFooterInfo(settings);
            updateLegend();
            
            // ë‹¬ë ¥ ë‹¤ì‹œ ë Œë”ë§
            renderCalendar();
            
            closeSettings();
            alert('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // í‘¸í„° ì •ë³´ ì—…ë°ì´íŠ¸
        function updateFooterInfo(settings) {
            const teamInfo = document.getElementById('teamInfo');
            const patternInfo = document.getElementById('patternInfo');
            
            if (settings.workType === 'dayshift') {
                patternInfo.textContent = 'ì£¼5ì¼ ê·¼ë¬´ (ì›”~ê¸ˆ), í† ì¼ ë° ê³µíœ´ì¼ íœ´ë¬´';
                teamInfo.innerHTML = `<strong>ì£¼ê°„ì¡°</strong> | ê·¼ë¬´ì‹œê°„: 08:00-17:00`;
            } else {
                patternInfo.textContent = '4ì¼ ê·¼ë¬´ â†’ 2ì¼ íœ´ë¬´ â†’ ë°˜ë³µ (12ì¼ ì‚¬ì´í´)';
                
                const shiftText = settings.startShift === 'day' ? 'ì£¼ê°„' : 
                                 settings.startShift === 'night' ? 'ì•¼ê°„' : 'íœ´ë¬´';
                
                if (settings.team && settings.team !== 'custom') {
                    teamInfo.innerHTML = `<strong>${settings.team}ì¡°</strong> | ì‹œì‘ì¼: ${settings.startDate} | ì‹œì‘ ê·¼ë¬´: ${shiftText}`;
                } else {
                    teamInfo.innerHTML = `ì‹œì‘ì¼: ${settings.startDate} | ì‹œì‘ ê·¼ë¬´: ${shiftText}`;
                }
            }
        }

        // ì´ˆê¸°í™”
        function init() {
            const saved = localStorage.getItem('shiftSettings');
            if (saved) {
                const settings = JSON.parse(saved);
                workType = settings.workType;
                
                if (settings.workType === 'rotating') {
                    const [year, month, day] = settings.startDate.split('-');
                    startDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
                    startShiftType = settings.startShift;
                }
                
                updateFooterInfo(settings);
                updateLegend();
            } else {
                // ê¸°ë³¸ê°’: Aì¡° ì„¤ì •
                const defaultSettings = {
                    team: 'A',
                    startDate: '2025-11-22',
                    startShift: 'night',
                    workType: 'rotating'
                };
                localStorage.setItem('shiftSettings', JSON.stringify(defaultSettings));
                updateFooterInfo(defaultSettings);
                updateLegend();
            }
            
            renderCalendar();
        }
        
        init();
    </script>
</body>
</html>
