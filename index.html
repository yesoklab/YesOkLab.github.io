<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WRISTORY - Premium Watch NFTs</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap');
        body { background-color: #0F111A; font-family: 'Inter', sans-serif; }
        .serif { font-family: 'Cinzel', serif; }
        .text-shadow { text-shadow: 0 4px 12px rgba(0,0,0,0.5); }
        @keyframes slideshow { 0% { opacity: 0; transform: scale(1.1); } 10% { opacity: 1; transform: scale(1); } 90% { opacity: 1; transform: scale(1); } 100% { opacity: 0; transform: scale(1.1); } }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        // ---------------------------------------------------------
        // 1. 데이터 및 설정 (Data & Config)
        // ---------------------------------------------------------

        const GEMINI_API_KEY = "AIzaSyD1v_KU4GiUE0QFWvFwda_KmRfoKWnBsD8"; // 

        const COLLECTIONS = [
            { id: 1, title: { en: "Ahn Jung-geun's Watch", ko: "안중근 의사의 시계" }, description: { en: "A symbol of patriotism and history.", ko: "애국심과 역사의 상징입니다." }, imageUrl: "https://amaranth-legal-sole-30.mypinata.cloud/ipfs/bafkreib2v7hcc72x3s2u2w5q5c4j7y5v3o6u5j4s6c7y7v3o6u5j4s6c7y", itemsCount: 1 },
            { id: 2, title: { en: "Kim Gu's Watch", ko: "김구 선생의 시계" }, description: { en: "A piece of Korean independence history.", ko: "한국 독립 역사의 한 조각입니다." }, imageUrl: "https://amaranth-legal-sole-30.mypinata.cloud/ipfs/bafkreiaohqebkvodjwrnwt3673zaijntc3uc2g5mxg6vfdydqpeaf77s4a", itemsCount: 1 },
            { id: 3, title: { en: "Yun Bong-gil's Watch", ko: "윤봉길 의사의 시계" }, description: { en: "Remembering the Shanghai patriotic deed.", ko: "상하이 의거를 기억하며." }, imageUrl: "https://amaranth-legal-sole-30.mypinata.cloud/ipfs/bafkreib5x3u5j4s6c7y7v3o6u5j4s6c7y7v3o6u5j4s6c7y7v3o6u5j4s6c", itemsCount: 0 },
            { id: 4, title: { en: "Lee Bong-chang's Watch", ko: "이봉창 의사의 시계" }, description: { en: "The Tokyo patriotic deed, a noble sacrifice.", ko: "도쿄 의거, 고귀한 희생." }, imageUrl: "https://amaranth-legal-sole-30.mypinata.cloud/ipfs/bafkreib3v3o6u5j4s6c7y7v3o6u5j4s6c7y7v3o6u5j4s6c7y7v3o6u5j4", itemsCount: 0 }
        ];

        const TRANSLATIONS = {
            en: {
                nav: { collections: "Collections", register: "Register", guide: "Guide", ai: "AI Chat" },
                hero: { title: "Timeless History on Your Wrist", subtitle: "Own a piece of history with our exclusive NFT collection of watches worn by Korean historical figures.", joinBtn: "Join Airdrop", exploreBtn: "Explore" },
                collection: { title: "Featured Collections", description: "Discover the stories behind these historical timepieces." },
                form: { title: "Airdrop Registration", subtitle: "Enter your Tezos address to participate.", label: "Tezos Address (tz1...)", placeholder: "tz1...", submit: "Register Now", verifying: "Verifying...", successTitle: "Registration Successful!", successMsg: "You have successfully registered for the airdrop.", registerAnother: "Register Another", error: "Invalid Tezos address format." },
                guide: { title: "How to Participate", steps: [{ title: "Create Kukai Wallet", desc: "Visit kukai.app and create a new wallet. (Log in with Google/Social)" }, { title: "Copy Address", desc: "Click the profile icon to copy your address (starts with tz1...)." }, { title: "Register Address", desc: "Paste your address in the registration form on this site." }, { title: "Check Airdrop", desc: "Check the 'NFT' tab in your wallet after the airdrop date." }] },
                ai: { title: "WRISTORY AI Assistant", initialMsg: "Hello! I am the Wristory AI. Ask me anything about our projects, collections, or the airdrop!", placeholder: "Type your question...", send: "Send", typing: "AI is typing...", error: "AI service is currently unavailable." }
            },
            ko: {
                nav: { collections: "컬렉션", register: "사전등록", guide: "가이드", ai: "AI 채팅" },
                hero: { title: "손목 위의 영원한 역사", subtitle: "한국 역사적 인물들의 시계를 NFT로 소장하세요. 시대를 초월한 가치를 전합니다.", joinBtn: "에어드랍 참여", exploreBtn: "둘러보기" },
                collection: { title: "주요 컬렉션", description: "역사적 시계에 담긴 이야기를 만나보세요." },
                form: { title: "에어드랍 사전등록", subtitle: "테조스 지갑 주소를 입력하여 참여하세요.", label: "테조스 지갑 주소 (tz1...)", placeholder: "tz1으로 시작하는 주소 입력", submit: "지금 등록하기", verifying: "확인 중...", successTitle: "등록 성공!", successMsg: "에어드랍 사전등록이 완료되었습니다.", registerAnother: "다른 주소 등록하기", error: "올바르지 않은 테조스 주소 형식입니다." },
                guide: { title: "참여 방법 가이드", steps: [{ title: "Kukai 지갑 생성", desc: "kukai.app 방문 후 지갑 생성 (구글/소셜 로그인)" }, { title: "주소 복사", desc: "프로필 아이콘 클릭 후 주소 복사 (tz1...)" }, { title: "주소 등록", desc: "본 사이트 등록 양식에 주소 붙여넣기" }, { title: "에어드랍 확인", desc: "에어드랍 지급일 이후 지갑 'NFT' 탭 확인" }] },
                ai: { title: "WRISTORY AI 어시스턴트", initialMsg: "안녕하세요! WRISTORY AI입니다. 프로젝트, 컬렉션, 에어드랍에 대해 궁금한 점을 물어보세요!", placeholder: "질문을 입력하세요...", send: "전송", typing: "AI가 답변을 작성 중...", error: "AI 서비스 연결 불가." }
            }
        };

        // ---------------------------------------------------------
        // 2. React 컴포넌트 (Components)
        // ---------------------------------------------------------

        const Container = ({ children, className }) => <div className={`bg-slate-800/50 backdrop-blur-lg border border-slate-700/50 rounded-2xl overflow-hidden shadow-2xl ${className}`}>{children}</div>;

        const HeroSlideshow = ({ artworks }) => {
            const [current, setCurrent] = React.useState(0);
            React.useEffect(() => {
                const timer = setInterval(() => setCurrent(c => (c + 1) % artworks.length), 5000);
                return () => clearInterval(timer);
            }, [artworks.length]);

            return (
                <div className="relative w-full h-[400px] md:h-[600px] rounded-3xl overflow-hidden mb-10">
                    {artworks.map((art, i) => (
                        <div key={art.id} className={`absolute inset-0 transition-opacity duration-1000 ${i === current ? 'opacity-100' : 'opacity-0'}`}>
                            <img src={art.imageUrl} alt="Hero" className="w-full h-full object-cover" style={{ animation: i === current ? 'slideshow 15s linear infinite' : 'none' }} />
                            <div className="absolute inset-0 bg-gradient-to-t from-[#0F111A] via-transparent to-transparent"></div>
                        </div>
                    ))}
                </div>
            );
        };

        const CollectionCard = ({ collection, language }) => {
            return (
                <Container className="group hover:-translate-y-2 transition-all duration-300 cursor-pointer">
                    <div className="h-64 overflow-hidden relative">
                        <img src={collection.imageUrl} alt={collection.title[language]} className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"/>
                        <div className="absolute inset-0 bg-black/20 group-hover:bg-black/0 transition-all"></div>
                        <div className="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black/30 backdrop-blur-[1px]">
                            <span className="bg-white/20 p-2 rounded-full border border-white/30 text-white">↗</span>
                        </div>
                    </div>
                    <div className="p-5">
                        <h3 className="text-xl font-bold serif text-slate-100 mb-2 group-hover:text-purple-300">{collection.title[language]}</h3>
                        <p className="text-slate-400 text-sm mb-4 line-clamp-2 h-10">{collection.description[language]}</p>
                        <div className="flex justify-between items-center text-xs font-medium text-slate-300 border-t border-slate-700/50 pt-4">
                            <span className="bg-slate-700/50 px-2 py-1 rounded">{collection.itemsCount > 0 ? `${collection.itemsCount} Items` : 'Limited'}</span>
                            <span className="text-purple-400">Tezos Chain</span>
                        </div>
                    </div>
                </Container>
            );
        };

        const AirdropForm = ({ language }) => {
            const t = TRANSLATIONS[language];
            const [address, setAddress] = useState('');
            const [status, setStatus] = useState({ submitted: false, address: '' });
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!/^(tz1|tz2|tz3|KT1)[1-9A-HJ-NP-Za-km-z]{33}$/.test(address)) {
                    setError(t.form.error); return;
                }
                setLoading(true);
                // 여기에 구글 시트 전송 로직 등 추가 가능
                setTimeout(() => {
                    setStatus({ submitted: true, address });
                    setLoading(false);
                }, 1000);
            };

            if (status.submitted) {
                return (
                    <div className="max-w-md mx-auto mt-10 p-8 bg-slate-800/50 rounded-2xl border border-green-500/30 text-center">
                        <h3 className="text-2xl font-bold text-white mb-2">{t.form.successTitle}</h3>
                        <p className="text-slate-300 mb-6">{t.form.successMsg}</p>
                        <button onClick={() => { setStatus({ submitted: false, address: '' }); setAddress(''); }} className="text-slate-400 hover:text-white underline text-sm">{t.form.registerAnother}</button>
                    </div>
                );
            }

            return (
                <div className="max-w-2xl mx-auto mt-10 bg-slate-800/80 p-8 rounded-3xl border border-slate-700 shadow-2xl">
                    <div className="text-center mb-8">
                        <h2 className="text-3xl font-bold serif text-white mb-3">{t.form.title}</h2>
                        <p className="text-slate-400">{t.form.subtitle}</p>
                    </div>
                    <form onSubmit={handleSubmit} className="space-y-6">
                        <div>
                            <label className="block text-sm font-medium text-slate-300 mb-2">{t.form.label}</label>
                            <input type="text" value={address} onChange={(e) => setAddress(e.target.value)} placeholder={t.form.placeholder} className="w-full px-5 py-4 bg-slate-900/50 border border-slate-600 rounded-xl text-white outline-none focus:border-purple-500 transition-all font-mono"/>
                            {error && <p className="mt-2 text-red-400 text-sm">{error}</p>}
                        </div>
                        <button type="submit" disabled={loading} className="w-full py-4 rounded-xl font-bold text-lg bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white shadow-lg transition-all">{loading ? t.form.verifying : t.form.submit}</button>
                    </form>
                </div>
            );
        };

        const AiAssistant = ({ language }) => {
            const t = TRANSLATIONS[language];
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const scrollRef = useRef(null);

            useEffect(() => { setMessages([{ role: 'model', text: t.ai.initialMsg }]); }, [language]);
            useEffect(() => { scrollRef.current?.scrollIntoView({ behavior: "smooth" }); }, [messages, isTyping]);

            const handleSend = async (e) => {
                e.preventDefault();
                if (!input.trim() || isTyping) return;
                const userMsg = input;
                setInput('');
                setMessages(prev => [...prev, { role: 'user', text: userMsg }]);
                setIsTyping(true);

                // Simple API Call to Gemini (No SDK required for simple HTML file)
                try {
                    if(!GEMINI_API_KEY) throw new Error("API Key Missing");
                    
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: userMsg }] }],
                            systemInstruction: { parts: [{ text: "You are the Wristory AI Assistant. Your role is to provide information about the WRISTORY NFT project, its collections (like Ahn Jung-geun and Kim Gu watches), and guide users on how to participate in the airdrop process. Please respond in Korean." }] }
                        })
                    });
                    const data = await response.json();
                    const reply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Error processing request.";
                    setMessages(prev => [...prev, { role: 'model', text: reply }]);
                } catch (err) {
                    console.error(err);
                    setMessages(prev => [...prev, { role: 'model', text: t.ai.error }]);
                } finally {
                    setIsTyping(false);
                }
            };

            return (
                <div className="max-w-4xl mx-auto h-[600px] bg-slate-800/50 rounded-2xl border border-slate-700 flex flex-col">
                    <div className="bg-slate-900/80 p-4 border-b border-slate-700 font-bold text-slate-200">{t.ai.title}</div>
                    <div className="flex-1 overflow-y-auto p-6 space-y-4">
                        {messages.map((msg, i) => (
                            <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                <div className={`max-w-[80%] p-4 rounded-2xl ${msg.role === 'user' ? 'bg-purple-600 text-white' : 'bg-slate-700 text-slate-200'}`}>{msg.text}</div>
                            </div>
                        ))}
                        {isTyping && <div className="text-slate-400 text-sm ml-4">{t.ai.typing}</div>}
                        <div ref={scrollRef} />
                    </div>
                    <form onSubmit={handleSend} className="p-4 bg-slate-900/80 border-t border-slate-700 flex gap-4">
                        <input type="text" value={input} onChange={e => setInput(e.target.value)} placeholder={t.ai.placeholder} className="flex-1 bg-slate-800 border border-slate-600 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500" />
                        <button type="submit" className="bg-purple-600 text-white px-6 py-3 rounded-xl font-bold">{t.ai.send}</button>
                    </form>
                </div>
            );
        };

        const Guide = ({ language }) => {
            const t = TRANSLATIONS[language];
            return (
                <div className="max-w-4xl mx-auto py-12 px-4">
                    <h2 className="text-3xl font-bold serif text-center mb-12 text-amber-200">{t.guide.title}</h2>
                    <div className="space-y-6">
                        {t.guide.steps.map((step, i) => (
                            <div key={i} className="flex gap-6 bg-slate-800/40 p-6 rounded-2xl border border-slate-700">
                                <div className="w-10 h-10 rounded-full bg-purple-600 flex items-center justify-center font-bold flex-shrink-0">{i+1}</div>
                                <div><h3 className="text-xl font-bold text-white mb-2">{step.title}</h3><p className="text-slate-300">{step.desc}</p></div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // ---------------------------------------------------------
        // 3. 메인 앱 (Main App)
        // ---------------------------------------------------------

        const App = () => {
            const [view, setView] = useState('HOME');
            const [lang, setLang] = useState('ko');
            const t = TRANSLATIONS[lang];

            return (
                <div className="min-h-screen pb-20">
                    {/* 네비게이션 */}
                    <nav className="sticky top-0 z-50 bg-[#0F111A]/90 backdrop-blur-md border-b border-slate-800">
                        <div className="max-w-7xl mx-auto px-6 h-20 flex justify-between items-center">
                            <div className="flex items-center gap-3 cursor-pointer" onClick={() => setView('HOME')}>
                                <img src="https://amaranth-legal-sole-30.mypinata.cloud/ipfs/bafkreiaohqebkvodjwrnwt3673zaijntc3uc2g5mxg6vfdydqpeaf77s4a" className="w-10 h-10 rounded-lg" />
                                <span className="text-2xl font-bold serif text-white">WRISTORY</span>
                            </div>
                            <div className="flex items-center gap-6 text-sm font-medium">
                                <button onClick={() => setView('HOME')} className={view === 'HOME' ? 'text-white' : 'text-slate-400'}>{t.nav.collections}</button>
                                <button onClick={() => setView('AIRDROP')} className={view === 'AIRDROP' ? 'text-white' : 'text-slate-400'}>{t.nav.register}</button>
                                <button onClick={() => setView('GUIDE')} className={view === 'GUIDE' ? 'text-white' : 'text-slate-400'}>{t.nav.guide}</button>
                                <button onClick={() => setView('AI')} className="bg-slate-800 text-purple-300 px-3 py-1 rounded-full border border-slate-600">{t.nav.ai}</button>
                                <button onClick={() => setLang(l => l === 'en' ? 'ko' : 'en')} className="w-8 h-8 rounded-full bg-slate-700 text-xs">{lang === 'en' ? 'KO' : 'EN'}</button>
                            </div>
                        </div>
                    </nav>

                    {/* 컨텐츠 영역 */}
                    <main className="relative z-10">
                        {view === 'HOME' && (
                            <div>
                                <div className="py-20 px-6 text-center bg-gradient-to-b from-[#0F111A] to-slate-900">
                                    <h1 className="text-5xl md:text-7xl font-bold serif text-white mb-6 text-shadow">{t.hero.title}</h1>
                                    <p className="text-xl text-slate-400 max-w-2xl mx-auto mb-10">{t.hero.subtitle}</p>
                                    <HeroSlideshow artworks={COLLECTIONS} />
                                    <div className="flex justify-center gap-4">
                                        <button onClick={() => setView('AIRDROP')} className="px-8 py-4 bg-white text-black font-bold rounded-full hover:bg-slate-200">{t.hero.joinBtn}</button>
                                    </div>
                                </div>
                                <div className="max-w-7xl mx-auto px-6 mt-10 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                    {COLLECTIONS.map(col => <CollectionCard key={col.id} collection={col} language={lang} />)}
                                </div>
                            </div>
                        )}
                        {view === 'AIRDROP' && <div className="py-12 px-6"><AirdropForm language={lang} /></div>}
                        {view === 'GUIDE' && <div className="py-12 px-6"><Guide language={lang} /></div>}
                        {view === 'AI' && <div className="py-12 px-6"><AiAssistant language={lang} /></div>}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
